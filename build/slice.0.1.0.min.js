!function(){"use strict";var a="front",b="back",c="straddle",d="on";window.sliceGeometry=function(b,d){var h,j,k=new THREE.Geometry;return b.faces.forEach(function(l){h=g(b,l),j=i(d,h),j==a?f(k,h):j==c&&e(d,k,h)}),k};var e=function(b,c,d){var e,g,i,k,l,m,n=d.length,o=[];for(e=0;n>e;e++)g=d[e],i=n>e+1?d[e+1]:d[0],k=h(g,i,b),l=j(b,g.vertex),m=j(b,i.vertex),l==a&&-1===o.indexOf(g)&&o.push(g),k&&o.push(k),m==a&&-1===o.indexOf(i)&&o.push(i);o.length>3?(f(c,[o[0],o[1],o[2]]),f(c,[o[2],o[3],o[0]])):f(c,o)},f=function(a,b){var c,d,e=[],f=a.vertices.length,g=[];b.forEach(function(b){return c=a.vertices.indexOf(b.vertex),-1!==c?e.push(c):(a.vertices.push(b.vertex),e.push(f),f+=1),b.normal&&g.push(b.normal),!d});var h=new THREE.Face3(e[0],e[1],e[2],g);a.faces.push(h)},g=function(a,b){return["a","b","c"].map(function(c,d){return{vertex:a.vertices[b[c]],normal:b.vertexNormals[d]}})},h=function(a,b,c){var d=new THREE.Line3(a.vertex,b.vertex),e=c.intersectLine(d);if(e){var f=a.vertex.distanceTo(e),g=f/d.distance(),h=a.normal.clone().lerp(b.normal,g).normalize();return{vertex:e,normal:h}}},i=function(e,f){var g=j(e,f[0].vertex),h=j(e,f[1].vertex),i=j(e,f[2].vertex);return g==b||h==b||i==b?g==a||h==a||i==a?c:b:g==a||h==a||i==a?g==b||h==b||i==b?c:a:d},j=function(c,e){var f=c.distanceToPoint(e);return 0>f?b:f>0?a:d}}();